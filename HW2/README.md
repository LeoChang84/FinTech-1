# HW2_資料收集與文字探勘共現性進行資料視覺化

文字探勘淘金：從客服聯繫紀錄找出淺在銷售機會  

---

## Part I 針對自訂議題收集相關文本


### 資料來源 - 
- **野村證券**所提供之NTU深耕客服資料檔  
--- 

## Part II 將收集到的文本用NER挑選出  

### 使用套件 -   
- `jieba` - 中文斷詞(分詞)套件。

安裝套件

```
pip3 install jieba
```

### 利用jieba分詞 -   
以下簡易列出5筆。  

| **原始對話紀錄** | **分詞後結果** |
| :-------------: |:-------------:|
| 客戶事件描述 | 客戶/ 事件/ 描述 |
| 去電確認開戶文件客戶說後來去買美元保單就不開戶了 | 去/ 電/ 確認/ 開戶/ 文件/ 客戶/ 說/ 後/ 來/ 去/ 買/ 美元/ 保單/ 就/ 不/ 開戶/ 了  |
| 不方說IPOMAIL | 不方說/ IPO/ MAIL |
| IPO忙先MAIL | IPO/ 忙/ 先/ MAIL |
| 家庭戶媽媽說女兒不開了，因為打工收入不穩定 | 家庭/ 戶/ 媽媽/ 說/ 女兒/ 不開/ 了/ ，/ 因為/ 打工/ 收入/ 不/ 穩定 |

### 計算分詞出現頻率 -   
以下簡易列出前10筆。  

| **term** | **score** |
| :-------------: |:-------------:|
| money | 46.107700 |
| 開戶 | 35.857617 |
| 客戶 | 33.526101 |
| 名單 | 32.948703 |
| ec | 32.943381 |
| 專刊 | 30.181565 |
| 分配 | 29.649564 |
| ipo | 28.954837 |
| 退休 | 27.301790 |
| 電子 | 23.492975 |

### 經過 NER Model 挑選之結果-   

以[A simple BiLSTM-CRF model for Chinese Named Entity Recognition](https://github.com/Determined22/zh-NER-TF)進行進行NER的詞性標記，將初步整理過格式的客服資料作為輸入資料。

  
### 標記分析 - 
- `範例資料` - 該 [Github](https://github.com/Determined22/zh-NER-TF) 所提供的test set資料相當準確，確實將每句話中的Entity標記出來。
- `客服資料` - 標記結果不是非常樂觀，常標記到一些不重要的詞, ex: 來電說。 原因可能有以下兩個: 
    >1.該篇文章很多內容皆是以簡寫表示，如上述的"來電說"。

    >2.可能該model是以中國的簡體字詞進行訓練, 在分析上中國簡體字用詞與台灣繁體用詞有相當差異。



![NER](images/NER.png)

--- 

## Part III 將文件與有分類過的單詞進行TDM
使對話紀錄與分詞結果成為一個稀疏矩陣。  

![TDM](images/TDM.PNG)

--- 

## Part IV 將TDM轉成Co-Occurrence Matrix
從Co-Occurrence Matrix中可觀察得知分詞與分詞之間相互關聯的程度。

![COM](images/COM.PNG)

--- 

## Part V 繪製出各類別之間的共現圖

### 共現圖

- Co-Occurence Matrix
    >1.用詞共線圖 - 以每筆通聯紀錄為一句
    ![](images/用詞共線圖_以每筆通聯紀錄為一句.png)

    >2.用詞共線圖 - 以每個客戶為一句
    ![](images/用詞共線圖_以每個客戶為一句.png)

![TAV](images/用詞共線圖_以每筆通聯紀錄為一句.png)

### 熱度圖 

![heatmap](images/用詞熱度圖_以每筆通聯紀錄為一句.png)

- TDM (Term-document matrix) : 
    >1.用詞熱度圖 - 以每筆通聯紀錄為一句
    ![](images/用詞熱度圖_以每筆通聯紀錄為一句.png)

    >2.用詞熱度圖 - 以每個客戶為一句
    ![](images/用詞熱度圖_以每個客戶為一句.png)

### 通電次數

- Callout 次數分佈圖
    > Callout次數/unique ID
    ![](images/callout次數分佈圖.png)


- 分析：
    >1.從共線圖中可以發現當客服使用"推"以及"買"這兩個詞彙時通常與"客戶"有高度相關，且高度的可能性進行基金/人民幣的相關議題

    >2.在callout次數中,可以明顯看出來對於特定的ID去來電的次數非常高, 在前三名中各有350,123與50次，可猜測為上述用戶有非常高的頻率在進行交易。